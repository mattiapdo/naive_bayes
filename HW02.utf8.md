---
title: "Homework 2"
author: "Mattia Podio"
date: "24 maggio 2018"
output: html_document
---



### Load Data and Look at Them

We will perform analysis on data from sensors placed as 5 different units on the body 

(*T* Torso, 
*RA* Rigth Arm,
*LA* Left Arm,
*RL* Right Leg,
*LL* Left Leg) 

of a person, while he was performing several activities.


```r
load(file = 'daily-sport.RData')
```

The activities are: 'walking', 'stepper', 'crosstr' and 'jumping', and there are 7500 observations for each class...


```r
table(dailysport$id)
```

```
## 
## crosstr jumping stepper walking 
##    7500    7500    7500    7500
```

Each sensor measure a specific quantity in the tree dimesional space, in particular:

- acceleration (x,y,z)

- radial acceleration (x,y,z)

- magnetic field (x,y,z)

Each feature is numerical, and there are no NAs:


```r
str(dailysport)
```

```
## 'data.frame':	30000 obs. of  46 variables:
##  $ id      : Factor w/ 4 levels "crosstr","jumping",..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ T-xAcc  : num  8.72 8.62 8.93 9.07 9.05 ...
##  $ T-yAcc  : num  2.14 2.05 2.05 2.08 1.98 ...
##  $ T-zAcc  : num  3.83 3.45 3.28 3.23 3.41 ...
##  $ T-xGyro : num  0.294 0.23 0.209 0.197 0.238 ...
##  $ T-yGyro : num  -0.252 -0.26 -0.344 -0.241 -0.098 ...
##  $ T-zGyro : num  -0.1506 -0.13245 -0.10109 -0.06141 -0.00907 ...
##  $ T-xMag  : num  -0.577 -0.586 -0.596 -0.605 -0.61 ...
##  $ T-yMag  : num  0.1086 0.0974 0.0896 0.0825 0.075 ...
##  $ T-zMag  : num  -0.697 -0.69 -0.684 -0.675 -0.672 ...
##  $ RA-xAcc : num  8.59 8.5 9.09 9.36 9.34 ...
##  $ RA-yAcc : num  3.51 3.77 3.8 3.77 3.94 ...
##  $ RA-zAcc : num  1.58 1.64 1.62 1.68 1.83 ...
##  $ RA-xGyro: num  0.492 0.252 0.168 0.25 0.269 ...
##  $ RA-yGyro: num  -0.224 -0.381 -0.421 -0.352 -0.276 ...
##  $ RA-zGyro: num  0.532 0.65 0.706 0.597 0.373 ...
##  $ RA-xMag : num  -0.532 -0.55 -0.574 -0.594 -0.614 ...
##  $ RA-yMag : num  -0.476 -0.472 -0.461 -0.452 -0.443 ...
##  $ RA-zMag : num  -0.594 -0.582 -0.571 -0.559 -0.545 ...
##  $ LA-xAcc : num  9.22 8.47 8.49 8.43 8.08 ...
##  $ LA-yAcc : num  -2.77 -2.76 -3.02 -3.07 -3.59 ...
##  $ LA-zAcc : num  3.06 2.72 2.51 2.54 3.06 ...
##  $ LA-xGyro: num  0.301 0.0294 -0.0944 -0.6035 -1.0688 ...
##  $ LA-yGyro: num  -0.0141 -0.0514 -0.0233 0.1012 0.1644 ...
##  $ LA-zGyro: num  -0.488 -0.379 -0.342 -0.325 -0.265 ...
##  $ LA-xMag : num  -0.484 -0.492 -0.503 -0.511 -0.52 ...
##  $ LA-yMag : num  0.727 0.717 0.712 0.709 0.711 ...
##  $ LA-zMag : num  -0.256 -0.262 -0.261 -0.251 -0.229 ...
##  $ RL-xAcc : num  -11.65 -10.9 -10.09 -8.85 -8.46 ...
##  $ RL-yAcc : num  0.112 -1.163 -1.985 -0.721 0.802 ...
##  $ RL-zAcc : num  0.464 1.118 1.285 1.398 1.577 ...
##  $ RL-xGyro: num  -1.69 -1.268 -0.476 -0.305 -0.278 ...
##  $ RL-yGyro: num  0.411 0.437 0.148 0.195 0.235 ...
##  $ RL-zGyro: num  1.55 1.68 1.57 1.55 1.36 ...
##  $ RL-xMag : num  0.794 0.763 0.727 0.689 0.646 ...
##  $ RL-yMag : num  -0.427 -0.485 -0.54 -0.587 -0.636 ...
##  $ RL-zMag : num  0.192 0.177 0.171 0.166 0.164 ...
##  $ LL-xAcc : num  -9.74 -9.53 -9.97 -9.66 -9.77 ...
##  $ LL-yAcc : num  -0.434 -0.495 1.045 -0.436 -0.523 ...
##  $ LL-zAcc : num  -1.46 -1.55 -1.27 -1.04 -1.66 ...
##  $ LL-xGyro: num  -0.291 -0.348 -0.417 -0.234 -0.344 ...
##  $ LL-yGyro: num  0.0618 0.0619 0.0789 -0.0764 0.0258 ...
##  $ LL-zGyro: num  0.32 0.291 0.297 0.478 0.407 ...
##  $ LL-xMag : num  0.8 0.805 0.811 0.817 0.823 ...
##  $ LL-yMag : num  0.437 0.43 0.423 0.412 0.397 ...
##  $ LL-zMag : num  -0.166 -0.159 -0.149 -0.144 -0.143 ...
```


```r
cat('NAs:',sum(is.na(dailysport)))
```

```
## NAs: 0
```

Let's reduce the dataset to two activities and drop the unused levels ('jumping' and 'walking').

This dataset is called 'ds.small', and contains just 3 sensors on one location
 

```r
ds.small = subset(x = dailysport, subset = id == "crosstr" | id == "stepper", select = c("id","RL-xMag","RL-yMag","RL-zMag"))
table(ds.small$id)
```

```
## 
## crosstr jumping stepper walking 
##    7500       0    7500       0
```

```r
# drop unused levels:
ds.small = droplevels(ds.small)
table(ds.small$id)
```

```
## 
## crosstr stepper 
##    7500    7500
```

```r
colnames(ds.small) = c("id", "RLxMag", "RLyMag", "RLzMag")
str(ds.small)
```

```
## 'data.frame':	15000 obs. of  4 variables:
##  $ id    : Factor w/ 2 levels "crosstr","stepper": 2 2 2 2 2 2 2 2 2 2 ...
##  $ RLxMag: num  0.91 0.904 0.885 0.865 0.856 ...
##  $ RLyMag: num  -0.304 -0.357 -0.414 -0.471 -0.495 ...
##  $ RLzMag: num  -0.39 -0.407 -0.425 -0.44 -0.446 ...
```


```r
library(plotly)
```

```
## Warning: package 'plotly' was built under R version 3.4.4
```

```
## Loading required package: ggplot2
```

```
## 
## Attaching package: 'plotly'
```

```
## The following object is masked from 'package:ggplot2':
## 
##     last_plot
```

```
## The following object is masked from 'package:stats':
## 
##     filter
```

```
## The following object is masked from 'package:graphics':
## 
##     layout
```

Plot 500 points in ds.small choosen at random, treating them as 3-dimensional data points


```r
p <- plot_ly(ds.small[sample(x = 1:nrow(ds.small), size = 500, replace = F) ,], 
             x = ~RLxMag, y = ~RLyMag, z = ~RLzMag, color = ~id, colors = c('lightcoral', 'lightskyblue3')) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = 'RL-xMag'),
                     yaxis = list(title = 'RL-yMag'),
                     zaxis = list(title = 'RL-xMag')))
p
```

preservedeb9cc431bdf2732

Split ds.small in ds.train and ds.test containing 70% and 30% of the original dataset respectively


```r
library(caret)
```

```
## Warning: package 'caret' was built under R version 3.4.4
```

```
## Loading required package: lattice
```


```r
partition = createDataPartition(y = ds.small$id, times = 1, p = 0.7, list = F)
ds.train = ds.small[partition,]
ds.test = ds.small[-partition,]
cat(paste('nrow(ds.train) + nrow(ds.test):', nrow(ds.train) + nrow(ds.test), '\nnrow(ds.small):', nrow(ds.small)))
```

```
## nrow(ds.train) + nrow(ds.test): 15000 
## nrow(ds.small): 15000
```

## Use the function lda() in the MASS package on ds.train to estimate a linear discriminant analysis model


```r
library(MASS) # for lda()
```

```
## 
## Attaching package: 'MASS'
```

```
## The following object is masked from 'package:plotly':
## 
##     select
```

```r
library(vegan) # for decostand()
```

```
## Warning: package 'vegan' was built under R version 3.4.4
```

```
## Loading required package: permute
```

```
## Warning: package 'permute' was built under R version 3.4.4
```

```
## This is vegan 2.5-2
```

```
## 
## Attaching package: 'vegan'
```

```
## The following object is masked from 'package:caret':
## 
##     tolerance
```

```r
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
```

```
## The following object is masked from 'package:MASS':
## 
##     select
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```


```r
stepper = subset(ds.train,subset = id =="stepper")
cross =  subset(ds.train,subset = id =="crosstr")
#summary(stepper)
#hist(stepper$RLxMag)

num_attr = c("RLxMag", "RLyMag", "RLzMag")
num_var_st = stepper[,num_attr]
num_var_cr = cross[,num_attr]

#Standardize concerning the stepper
num_stand_step = decostand(num_var_st, "standardize")
colnames(num_stand_step) =  c("RLxMag", "RLyMag", "RLzMag")
#hist(num_stand_step$RLxMag)

#Standardize concerning the crosstr
num_stand_cross = decostand(num_var_cr, "standardize")
colnames(num_stand_cross) =  c("RLxMag", "RLyMag", "RLzMag")
#hist(num_stand_cross$RLyMag)

#Reobtain the data but now transformed
#for step
new.step=cbind(stepper,num_stand_step)
new_step = subset(new.step,select = c("id","RLxMag","RLyMag","RLzMag"))
#for cross
new.cross=cbind(cross,num_stand_cross)
new_cross = subset(new.cross,select = c("id","RLxMag","RLyMag","RLzMag"))

#Final

final = full_join(new_step,new_cross)
```

```
## Joining, by = c("id", "RLxMag", "RLyMag", "RLzMag")
```

```r
lda.out <- lda(formula = id ~ ., 
         data = final, 
         prior = c(1,1)/2)
lda.out
```

```
## Call:
## lda(id ~ ., data = final, prior = c(1, 1)/2)
## 
## Prior probabilities of groups:
## crosstr stepper 
##     0.5     0.5 
## 
## Group means:
##            RLxMag     RLyMag     RLzMag
## crosstr 0.5568898 -0.1790073 -0.1456959
## stepper 0.8333852 -0.2109965 -0.4192002
## 
## Coefficients of linear discriminants:
##               LD1
## RLxMag   8.920164
## RLyMag  -3.945635
## RLzMag -26.363949
```

## Predict the class-labels on the training set


```r
pred.tr = predict(object = lda.out, ds.train)
table(predict = pred.tr$class, true  = ds.train$id)
```

```
##          true
## predict   crosstr stepper
##   crosstr    5250       0
##   stepper       0    5250
```

## Predict the class-labels on the test set


```r
pred.te = predict(object = lda.out, ds.test)
table(predict = pred.te$class, true  = ds.test$id)
```

```
##          true
## predict   crosstr stepper
##   crosstr    2250       0
##   stepper       0    2250
```

